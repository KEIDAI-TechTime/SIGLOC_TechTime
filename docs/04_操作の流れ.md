# 操作の流れ

このページでは、実際にシステムを操作する手順を説明します。

---

## 事前準備

### 必要なもの

- **Googleアカウント**（システムアカウントを使用）
- **インターネット接続**
- **Webブラウザ**（Chrome推奨）

### システムの場所

システムは**Google Drive**内の以下のフォルダにあります。

```
Google Drive
└── PreparationForNextSIGLOC/
    ├── 10_SIGLOC-online新期開始時サポートシステム/
    │   └── SIGLOC-online新期開始時サポートシステム.xlsx  ← これを開く
    │
    └── 20_事後レポート作成システム/
        └── 事後レポート作成システム.xlsx  ← これを開く
```

---

## システム1: 新期開始時サポートシステムの操作

### 全体の流れ

```
Step 0    Step 1    Step 2    Step 3    Step 4    Step 5    Step 6
  │         │         │         │         │         │         │
  ▼         ▼         ▼         ▼         ▼         ▼         ▼
┌────┐   ┌────┐   ┌────┐   ┌────┐   ┌────┐   ┌────┐   ┌────┐
│事前│   │各種│   │ｼｽﾃﾑ│   │Form│   │ﾃﾝﾌﾟﾚ│   │Check│   │修了│
│設定│ → │ﾌｫﾙﾀﾞ│ → │ﾌｧｲﾙ│ → │更新│ → │ｰﾄ  │ → │List│ → │証 │
└────┘   └────┘   └────┘   └────┘   └────┘   └────┘   └────┘
           │         │         │         │         │         │
         作成      作成      作成      作成      作成      作成
         ↓         ↓         ↓         ↓         ↓         ↓
        テスト    テスト    テスト    テスト    テスト    テスト
```

---

### Step 0: 事前設定

**やること**: 前回・今回のフォルダ情報を設定する

1. **新しいSIGLOCフォルダを作成**
   - Google Drive上で「SIGLOC」フォルダを開く
   - 新しいフォルダを作成（例: `2025_21st_July`）

2. **フォルダIDを取得**
   - フォルダを開く
   - URLの`folder/`以降の文字列がID
   ```
   https://drive.google.com/drive/folders/XXXXXXXXXXXXX
                                          ↑ ここがフォルダID
   ```

3. **システムを開いて設定**
   - `SIGLOC-online新期開始時サポートシステム.xlsx`を開く
   - 「設定」シートを選択
   - 以下を入力:

   | 項目 | 入力例 |
   |------|--------|
   | 前回フォルダID | （20th回のフォルダID） |
   | 今回フォルダID | （21st回のフォルダID） |
   | 前回開催回 | 20th |
   | 今回開催回 | 21st |

---

### Step 1〜6: 各機能の実行

**やること**: 「手順」シートで各機能を順番に実行する

1. **「手順」シートを開く**

2. **各ステップを順番に実行**

   ```
   【手順シートの画面イメージ】

   ┌─────────────────────────────────────────────────────┐
   │                                                     │
   │  ステップ        作成ボタン       テストボタン     │
   │  ─────────────────────────────────────────────     │
   │  1. 各種フォルダ   [作成]           [テスト]        │
   │  2. ｼｽﾃﾑﾌｧｲﾙ      [作成]           [テスト]        │
   │  3. GoogleForm    [作成]           [テスト]        │
   │  4. StudentWork   [作成]           [テスト]        │
   │  5. MyCheckList   [作成]           [テスト]        │
   │  6. 修了証        [作成]           [テスト]        │
   │                                                     │
   └─────────────────────────────────────────────────────┘
   ```

3. **各ステップの操作**

   ```
   [作成] ボタンをクリック
        ↓
   確認ダイアログ「〇〇を作成します。よろしいですか？」
        ↓
   「OK」をクリック
        ↓
   処理実行（数分かかる場合があります）
        ↓
   完了ダイアログ「〇〇を作成しました」
        ↓
   [テスト] ボタンをクリック
        ↓
   テスト実行
        ↓
   結果を「チェックリスト」シートで確認
   ```

4. **結果の確認**
   - 「チェックリスト」シートを開く
   - ○が付いていれば正常
   - ×が付いていたら手動で修正が必要

---

### 初回実行時の注意

**セキュリティ警告が表示される場合**

初めてシステムを実行すると、Googleから警告が表示されます。

```
┌─────────────────────────────────────────────┐
│  このアプリは確認されていません            │
│                                             │
│  このアプリは、Googleで確認されて           │
│  いません。信頼できる場合のみ続行          │
│  してください。                             │
│                                             │
│        [詳細]  [安全なページに戻る]         │
└─────────────────────────────────────────────┘
```

**対処方法**:
1. 「詳細」をクリック
2. 「〇〇（安全でないページ）に移動」をクリック
3. 「許可」をクリック

---

### よくあるエラーと対処

| エラー | 原因 | 対処 |
|--------|------|------|
| 「フォルダIDが指定されていません」 | 設定シートが未入力 | 設定シートにIDを入力 |
| 「タイムアウト」 | 処理に6分以上かかった | もう一度実行するか、手動で続きを行う |
| テストで×が出る | 一部のファイルがコピーできなかった | 手動でコピーする |

---

## システム2: 事後レポート作成システムの操作

### 全体の流れ

```
Step 1              Step 2              Step 3
  │                   │                   │
  ▼                   ▼                   ▼
┌─────────┐        ┌─────────┐        ┌─────────┐
│設定を   │   →   │レポート │   →   │レポート │
│確認    │        │作成    │        │を確認  │
└─────────┘        └─────────┘        └─────────┘
```

---

### Step 1: 設定の確認

1. **システムを開く**
   - `事後レポート作成システム.xlsx`を開く

2. **設定シートを確認**
   - 以下が正しく設定されているか確認:

   | 項目 | 内容 |
   |------|------|
   | ドキュメントID | アンケート回答データのID |
   | フォルダID | レポート出力先のフォルダID |
   | ベースファイル(日本語)ID | 日本語テンプレートのID |
   | ベースファイル(英語)ID | 英語テンプレートのID |

---

### Step 2: レポート作成

1. **ボタンをクリック**
   - 日本語版を作成したい場合 → 「日本語」ボタン
   - 英語版を作成したい場合 → 「英語」ボタン

   ```
   ┌─────────────────────────────────────────┐
   │                                         │
   │   レポート作成                          │
   │                                         │
   │   [日本語版を作成]   [英語版を作成]     │
   │                                         │
   └─────────────────────────────────────────┘
   ```

2. **確認ダイアログ**
   - 「〇〇版のレポートを作成します。よろしいですか」
   - 「OK」をクリック

3. **処理実行**
   - 数分かかります
   - 完了すると「レポートを作成しました」と表示

---

### Step 3: レポートの確認

1. **出力先フォルダを開く**
   - `report`フォルダ内に新しいファイルが作成されています

2. **ファイル名の例**
   - `FeedbackResult_JP_20250327_163726.docx`
   - `FeedbackResult_EN_20250327_163726.docx`

3. **内容を確認**
   - グラフが正しく表示されているか
   - テキストが正しく集計されているか
   - 必要に応じて手動で調整（箇条書きなど）

---

## 手動で行う作業（システムでできないこと）

システムで自動化できない作業は、手動で行う必要があります。

### 新期開始時サポートシステム使用後

| 作業 | 理由 |
|------|------|
| Shared Table、MyOneSlideのコピー | 自動コピー対象外のため |
| オリエンテーションクイズのコピー | 自動コピー対象外のため |
| フォーム内の日時の修正 | 細かい日時は手動設定が必要 |
| スマートチップのリンク更新 | 技術的に自動更新不可 |
| 応募フォームの公開設定 | 手動で「回答を受け付ける」に変更 |

### 事後レポート作成システム使用後

| 作業 | 理由 |
|------|------|
| 箇条書きの整形 | 自動では箇条書きにならないため |
| グラフの微調整 | 必要に応じてデザイン調整 |

---

## トラブルシューティング

問題が起きた場合は → [05_よくある質問.md](./05_よくある質問.md)

---

## 詳細な操作手順書

より詳しい操作手順は、以下のファイルを参照してください。

| ファイル | 場所 |
|----------|------|
| SIGLOC-online新期開始時サポートシステムの使い方 | `99_資料など/3_操作手順書/` |
| 事後レポート作成システムの使い方 | `99_資料など/3_操作手順書/` |
