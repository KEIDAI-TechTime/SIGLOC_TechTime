# **事後レポート作成システム**

## **1. 概要**

本処理は、日本語版および英語版のレポートを作成する機能を提供する。

## **2. 関数一覧**

## 

| 関数名           | 説明                               |
|------------------|------------------------------------|
| callJapanese     | 日本語版レポートを作成する         |
| callEnglish      | 英語版レポートを作成する           |
| callCreateReport | 指定言語のレポートを作成する       |
| checkId          | 必要なIDが設定されているか確認する |

## **3. 共通処理**

### **3.1 事前チェック**

> 各関数で checkId を使用し、以下のパラメータの設定を確認。

- fileId が空でないこと

- folderId が空でないこと

- baseFileJpId が空でないこと

- baseFileEnId が空でないこと

> エラー時のメッセージ:

- "ドキュメントIDが指定されていないため実行できません。"

- "フォルダIDが指定されていないため実行できません。"

- "ベースファイル(日本語)のIDが指定されていないため実行できません。"

- "ベースファイル(英語)のIDが指定されていないため実行できません。"

## **4. 各関数の処理詳細**

### **callJapanese**

1.  callCreateReport(LangType.JP) を呼び出し。

### **callEnglish**

1.  callCreateReport(LangType.EN) を呼び出し。

### **callCreateReport**

1.  checkId で事前チェック。

2.  言語に応じた確認ダイアログを表示。

    1.  日本語: "日本語版のレポートを作成します。よろしいですか"

    2.  英語: "英語版のレポートを作成します。よろしいですか"

3.  OsakaUni.createReport を呼び出してレポートを作成。

4.  完了ダイアログを表示。

### **checkId**

1.  下記のチェックを実施

    1.  fileId が空でないか確認。

    2.  folderId が空でないか確認。

    3.  baseFileJpId が空でないか確認。

    4.  baseFileEnId が空でないか確認。

2.  いずれかが空の場合、該当のエラーメッセージを表示し false を返す。

3.  すべてのチェックを通過した場合 true を返す。

## **5. 参照ライブラリ**

COIL

> 01_Report.gs
