siglocOnlineSupportSystem/06_CompletionCertificate

createCompletionCertificate

### **1. 処理の流れ**

#### **1. 初期設定**

- **ログの設定**

  - ログを記録するために **settingLog** を呼び出す。

- **引数のチェック**

  - フォルダIDや開催回情報が正しく渡されているかを確認する。

  - **checkFolderId**で今回のフォルダIDを検証。

  - **checkString** で今回の開催回情報を検証。

  - **checkFolderId** で前回のフォルダIDを検証。

  - **checkString** で前回の開催回情報を検証。

**確認の実施**

- **システム設定ファイルの取得**

  - 今回システム設定ファイルを取得。

  - 今回のシステム設定シートを取得。

#### **2. フォルダとファイルの検索**

- **前回の 修了証 関連フォルダを検索**

  - **前回の Online フォルダを検索し、IDを取得。**

  - **前回の SYSTEMフォルダを検索し、IDを取得。**

  - **前回の** 修了証**フォルダを検索し、IDを取得。**

- **前回の 修了証 ファイルを取得**

  - **前回の** 修了証**ファイルを検索し、IDを取得。**

- **今回の 修了証 関連フォルダを検索**

  - **今回の Online フォルダを検索し、IDを取得。**

  - **今回の SYSTEMフォルダを検索し、IDを取得。**

  - **今回の** 修了証**フォルダを検索し、IDを取得。**

#### **3. システム設定ファイルの取得**

- **システム設定ファイルを取得**

- **今回のシート('SIGLOC\_' + XX + 'th') を取得**

#### **4. 修了証 のコピー＆リネーム**

- **前回の修了証を今回にコピーし前回の開催名を今回の開催にリネーム。**

- **コピー後の 修了証 のファイルIDを システム設定ファイル に設定**

#### **5. システム設定ファイルの更新**

- **フォルダのIDをシステム設定ファイルに更新**

| **システム設定キー**       | **更新する値**                        |
|----------------------------|---------------------------------------|
| CERTIFICATE_BASE_FOLDER_ID | 修了証原本のフォルダID                |
| CERTIFICATE_FOLDER_ID      | Certificate of CompletionのフォルダID |

#### **6. フォルダIDの返却**

- thisTimeFolderId を返却し、次の処理へ渡す。

### **2. 連携モジュール**

#### **呼び出し元**

- **SIGLOC-online新期開始時サポートシステム**

  - **callApi.gs**

#### **参照**

- **同プロジェクト**

  - **check.gs** … チェック処理部品

  - **util.gs** … 共通処理部品
